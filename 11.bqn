âŸ¨Int, _splitâŸ©â†â€¢Import "util.bqn"
lines â† â€¢file.Lines "11.input"
Operation â† { ğ•Š"old": "âŠ¢"; ğ•Š"*": "Ã—"; ğ•Š"+": "+"; ğ•Šğ•©: ğ•©âˆ¾'Ë™' }
Monkey â† { ğ•Šm:
 items â† IntÂ¨ (Ã—â‰ Â¨)âŠ¸/ (('0'+â†•10) Â¬âˆ˜âˆŠËœ âŠ¢) _split 1 âŠ‘ m
 op â† â€¢BQN âˆ¾ OperationÂ¨ (' '=âŠ¢) _split (â‰ "  Operation: new = ") â†“ 2 âŠ‘ m
 test â† Int (â‰ "  Test: divisible by ") â†“ 3 âŠ‘ m
 true â† Int (â‰ "    If true: throw to monkey ") â†“ 4 âŠ‘ m
 false â† Int (â‰ "    If false: throw to monkey ") â†“ 5 âŠ‘ m
 itemsâ€¿opâ€¿testâ€¿trueâ€¿false
}

monkeys â† start â† > MonkeyÂ¨ (0=â‰ Â¨) _split lines
n â† Ã—Â´ 2 âŠË˜ monkeys
inspected â† (â‰ monkeys) â¥Š 0
relief â† 3
Run â† { ğ•Š turn:
 itemsâ€¿opâ€¿testâ€¿trueâ€¿false â† turn âŠ monkeys
 inspected â†© ((â‰ items)+âŠ¢)âŒ¾(turn âŠ‘ âŠ¢) inspected
 worry â† n | âŒŠ relief Ã·Ëœ Op items
 dirs â† (0 â‰  test | worry) âŠ âŸ¨true, falseâŸ©
 throws â† dirs ((Â·â·âŠ£) â‹ˆÂ¨ âŠâŠ¸âŠ”) worry
 monkeys â†© âŸ¨âŸ©âŒ¾(turnâ€¿0 âŠ‘ âŠ¢) monkeys
 { ğ•Š dirâ€¿thrown: monkeys â†© (âŠ¢âˆ¾Thrown)âŒ¾(dirâ€¿0 âŠ‘ âŠ¢) monkeys }Â¨ throws
 @
}
Reset â† {ğ•Šğ•©: monkeys â†© start, inspected â†© (â‰ monkeys) â¥Š 0}
p1 â† { Reset @, relief â†© 3, {ğ•Šğ•©: RunÂ¨â†•â‰ monkeys}âŸ20    @, Ã—Â´2â†‘âˆ¨inspected }
p2 â† { Reset @, relief â†© 1, {ğ•Šğ•©: RunÂ¨â†•â‰ monkeys}âŸ10000 @, Ã—Â´2â†‘âˆ¨inspected }
p1â€¿p2
